
<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		body {
			font-family: "Lato", sans-serif;
		}

		.text-black{
			color:#000000;
		}

		.back{
			color:white;
			font-size: 1em
		}
		.back:hover{

			color:#1380cf;
			font-size: 1.2em;

		}

		.arrow {
			color: black;
			border: solid black;
			border-width: 0 3px 3px 0;
			display: inline-block;
			padding: 3px;
		}
		.left {
			transform: rotate(135deg);
			-webkit-transform: rotate(135deg);
		}
		.speeddial{
			font-size: 1.2em;
			margin-left: 20px;
			color: white;
		}


		.nav-scroller .nav {
			display: -ms-flexbox;
			display: flex;
			-ms-flex-wrap: nowrap;
			flex-wrap: nowrap;
			padding-bottom: 1rem;
			margin-top: -1px;
			overflow-x: auto;
			color: rgba(255, 255, 255, .75);
			text-align: center;
			white-space: nowrap;
			-webkit-overflow-scrolling: touch;
		}

		.nav-underline .nav-link {
			padding-top: .75rem;
			padding-bottom: .75rem;
			font-size: .875rem;
			color: #6c757d;
		}

		.nav-underline .nav-link:hover {
			color: #007bff;
		}

		.nav-underline .active {
			font-weight: 500;
			color: #343a40;
		}

		.default{
		 color: darkgreen;
		}

		.warning{
			color:orange;
		}

		.noavail{
			color:red ;
		}


		.selval{
			color: white;
			font-size: 1.5em;
			text-decoration: none;
		}

		.selval:hover{
			color: #1380cf;
		}


		.text-white-50 { color: rgba(255, 255, 255, .5); }

		.bg-purple { background-color: #6f42c1; }

		.border-bottom { border-bottom: 1px solid #e5e5e5; }

		.box-shadow { box-shadow: 0 .25rem .75rem rgba(0, 0, 0, .05); }


		.bg-dattoblue {

			background-color: rgba(255, 255, 255, 0.5)
		}

		.bg-bodymain{

			background-color: #2c3034;
		}

		.snallcard{

			width: 2em;

			text-align: center;
			display: inline-block
		}
		td{
			padding: 3px;
		}


	</style>
</head>
<body class="bg-bodymain">



		<h3 id="header" style="color:whitesmoke;padding: 30px">Loading....</h3>



<div id="tableView" class="container" style="display: none">

	<table>


<thead>
<tr style="color: white"><td></td><td>L1</td><td>L2</td><td>Speed Dial</td></tr>
</thead>
			<tr class="row>" >
			<td><a  class="selval sidenav" name="Azure">Azure</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="Azure_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="Azure_L1queue" class="card mb-32 h-50"><div >
							<p id="Azure_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Azure_SD" style="font-size:1.5em" >61</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="CC4PC">Cloud Continuity</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="CC4PC_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="CC4PC_L1queue" class="card mb-32 h-50"><div >
							<p id="CC4PC_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Cloud Continuity_SD" style="font-size:1.5em" >64</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="BCDR">BCDR</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="BCDR_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="BCDR_L1queue" class="card mb-32 h-50"><div >
							<p id="BCDR_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="BCDR_SD" style="font-size:1.5em" >62</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="BFY">Backupify</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="BFY_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="BFY_L1queue" class="card mb-32 h-50"><div >
							<p id="BFY_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Backupify_SD" style="font-size:1.5em" >63</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="WRK_PLC">Workplace</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="WRK_PLC_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="WRK_PLC_L1queue" class="card mb-32 h-50"><div >
							<p id="WRK_PLC_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Workplace_SD" style="font-size:1.5em" >73</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="Infocyte">Infocyte</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="Infocyte_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="Infocyte_L1queue" class="card mb-32 h-50"><div >
							<p id="Infocyte_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Infocyte_SD" style="font-size:1.5em" ></p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="SaaS_DFNS">SaaS Defence</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="SaaS_DFNS_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="SaaS_DFNS_L1queue" class="card mb-32 h-50"><div >
							<p id="SaaS_DFNS_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="SaaS Defence_SD" style="font-size:1.5em" >71</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="RMM">RMM</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="RMM_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="RMM_L1queue" class="card mb-32 h-50"><div >
							<p id="RMM_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="RMM_SD" style="font-size:1.5em" >70</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="PSA">PSA</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="PSA_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="PSA_L1queue" class="card mb-32 h-50"><div >
							<p id="PSA_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="PSA_SD" style="font-size:1.5em" >69</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="NET_HW">Networking</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="NET_HW_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="NET_HW_L1queue" class="card mb-32 h-50"><div >
							<p id="NET_HW_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Networking_SD" style="font-size:1.5em" >67</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="NET_MGMT">Cloud Management</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="NET_MGMT_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="NET_MGMT_L1queue" class="card mb-32 h-50"><div >
							<p id="NET_MGMT_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Cloud Management_SD" style="font-size:1.5em" >68</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="FILE_PRO">File Protection</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="FILE_PRO_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="FILE_PRO_L1queue" class="card mb-32 h-50"><div >
							<p id="FILE_PRO_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="File Protection_SD" style="font-size:1.5em" >66</p></div>

			</td>

		</tr>

			<tr class="row>" >
			<td><a  class="selval sidenav" name="COMM">Commerce</a></td>
			<td>
			<div class="snallcard">
				<div  class="card mb-32 h-50"><div >
						<p id="COMM_L1" style="font-size:1.5em" >0</p></div></div>
				 </div>
			</td>

			<td>
				<div class="snallcard">
					<div id="COMM_L1queue" class="card mb-32 h-50"><div >
							<p id="COMM_L2" style="font-size:1.5em" >0</p></div></div>
				</div>
			</td>


			<td>
				<div class="snallcard speeddial" s>

							<p id="Commerce_SD" style="font-size:1.5em" >65</p></div>

			</td>

		</tr>

	
	</table >
</div>


<div id="main" role="main" class="container"  style="display: none">


	<div id="phone"></div>


	<p class="back"><i class="arrow left"></i>Back</p>

</div>

		<div id="phone"></div>



</div>

</body>
</html>


<!-- Bootstrap core JavaScript
================================================== -->
<script src="vendor/jquery/jquery-3.3.1.min.js"></script>
<script src="vendor/jquery-ui-1.12.1/jquery-ui.min.js"></script>
<script src="vendor/jquery-ui-1.12.1/jquery-ui.js"></script>
<script src="vendor/bootstrap5/js/bootstrap.js"></script>
<script src="vendor/popper/popper.min.js"></script>
<script src="vendor/cookie/js.cookie.js"></script>


<link href="vendor/bootstrap5/css/bootstrap.min.css" rel="stylesheet">
<link href="vendor/jquery-ui-1.12.1/jquery-ui.structure.css" rel="stylesheet">
<link href="vendor/jquery-ui-1.12.1/jquery-ui.theme.css" rel="stylesheet">
<link href="vendor/jquery-ui-1.12.1/jquery-ui.css" rel="stylesheet">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">










<script>
	const LevelStructure = JSON.parse('["L1", "L1_Blue", "L1_Pro", "L2", "L2_Blue"]');
	const Skills = '["Azure","COMM", "FILE_PRO", "NET_HW", "PSA", "RMM", "SaaS", "SaaS_DFNS", "Infocyte", "WRK_PLC","BFY", "BCDR"]';

	var firstRun
	var selectedFocus ="";
	var AllSkills = new Map();

	var saved = new Object()
	saved = {
		Azure : [],
		BFY : [],
		COMM : [],
		FILE_PRO : [],
		NET_HW: [],
		PSA: [],
		RMM: [],
		SaaS: [],
		SaaS_DFNS: [],
		Infocyte: [],
		WRK_PLC: [],
		BCDR : []
	}




	// Make cards per skill per selected  level
	$('.chk').change(function() {

		if (this.checked == true){
			CreateNewCard(this.value-1)
		} else
		{
			RemoveCard(this.value-1)
		}
		var  checkarray = [];
		$.each($("input[name='checkboxes']:checked"), function(){
			checkarray.push($(this).val());
		});
		saved[selectedFocus]=checkarray;
		Cookies.set('saved', JSON.stringify(saved), { sameSite: 'strict' ,expires: 365 })

	});
	function CreateNewCard(role){


		MakeCard(role,selectedFocus);

		loc = selectedFocus +'_'+ LevelStructure[role]
		id = "#"+loc;
		$(id).html(AllSkills.get(loc));



	}
	function RemoveCard(role){
		removediv ='#'+selectedFocus+'_'+role+'-main';
		$(removediv).remove();
	}
	function MakeCard(role,phoneskill){
	var y



	y = phoneskill +'_'+ LevelStructure[role];






		$('#phone').append(
				$('<div id="'+phoneskill +'_'+role+'-main-Large"  style="width: 17em;padding:.5em;display: inline-block" >' +
						'<div id="'+phoneskill + LevelStructure[role]+'-Large" class="card mb-32 h-50 ">' +
						'<div class="card-body  bg-dattoblue ">' +
						'<p id="'+phoneskill + LevelStructure[role]+'-title-Large" class="card-title text-black"><b>' + phoneskill +'  '+ LevelStructure[role] +'</b></p>' +
						'<p id="'+phoneskill + '_'+LevelStructure[role]+'-Large'+'" style="font-size:7em"><span style="visibility:hidden">0</span></p></div></div></div>'));






	};


	function GetAllData() {

		jQuery.ajax({
			type: "GET",
			url: "/UpdateStatus",
			dataType: 'json',
			cache: false,
			success: function (data) {
				var x;
				var y;

				if( firstRun  !== 1) {
					tableFadeIn();
				}

				firstRun = 1;

				$("#header").html("Agents Available for Calls");
				for (const [key, value] of Object.entries(data)) {
					x = key;
					y = value;
					if (x) {

						xLocationref = x.replace(/[\[\]']+/g,'');
						id = "#"+xLocationref;

						AllSkills.set(x, y);

						$(id).removeClass('default').removeClass('noavail').removeClass('warning');
						$(id+'-Large').removeClass('default').removeClass('noavail').removeClass('warning')
						if (y == 1){

							$(id).addClass('warning');
							$(id+'-Large').addClass('warning')
						}

						if (y == 0){

							$(id).addClass('noavail');
							$(id+'-Large').addClass('noavail');
						}


						if (y >= 2){

							$(id).addClass('default');
							$(id+'-Large').addClass('default');
						}


						$(id+'-Large').html(y);
						$(id).html(y);
					}

				}



			}
		});

	}

	$("body").on("click", ".selval", function(){

		var selectedRole = this.name;
		$("#tableView").fadeOut();
		$("#main").fadeIn();
		//remove all current skills
		$('#phone').html("");
		$.each(JSON.parse(Skills), function (y) {
			var phoneskill

			phoneskill =JSON.parse(Skills)[y];


			saved[phoneskill].forEach(item => RemoveCard(item-1,phoneskill));
		});

		$.each(LevelStructure, function (y) {


			MakeCard(y,selectedRole);
			updateQVal(y, selectedRole)
		});

		function updateQVal(y,role){
			x = role +'_'+ LevelStructure[y]
			$('#Azure_L1-Large')

			val = AllSkills.get(x);
			div= '#'+x;

		//	$(div+'-Large').addClass('warning');



			$(div).html(val);
			$(div+'-Large').html(val);

			$(div).removeClass('default').removeClass('warning').removeClass('noavail');
			$(div+'-Large').removeClass('default').removeClass('warning').removeClass('noavail');

			if (val == 1){
				$(div).addClass('warning');
				$(div+'-Large').addClass('warning');
			}
			if (val == 0){
				$(div).addClass('noavail');
				$(div+'-Large').addClass('noavail');
			}

			if (val >= 2){
				$(div+'-Large').addClass('default');
				$(div).addClass('default');
			}

		}

	});


	$(document).ready(function () {
		var selected = [];


		// Load Cookies

		if (Cookies.get('saved') == undefined){
			Cookies.set('saved', JSON.stringify(saved), { sameSite: 'strict' ,expires: 365 })
		} else
		{
			cookiefile =Cookies.get('saved');
			saved = JSON.parse(cookiefile);

		}




		$.each(JSON.parse(Skills), function (y, item) {
			$('#typedropdown').append($('<option>', {
				value: item,
				text : item
			}));
			$('#viewMenu').prepend('<li><a class="dropdown-item selval" href="#">'+item+'</a></li>');


		});
// set dropdown list

		selectedFocus =  JSON.parse(Skills)[0];
// checkbox stuff
		for( var x = 1; x < 6; x++){
			$('#checkboxes-'+x).prop('checked', false);
		}

		$('#chkboxlabel').text(selectedFocus);


		saved[selectedFocus].forEach(item => $('#checkboxes-'+item).prop('checked', true));

		$("input:checkbox[name=checkboxes]:checked").each(function(){
			selected.push($(this).val());
		});


		$( "#typedropdown").change(function() {
			$('#chkboxlabel').text(this.value);
			selectedFocus = this.value;
			for( var x = 1; x < 6; x++){
				$('#checkboxes-'+x).prop('checked', false);
			}
			saved[this.value].forEach(item => $('#checkboxes-'+item).prop('checked', true));
		});

		$.each(JSON.parse(Skills), function (y) {
			var phoneskill

			phoneskill =JSON.parse(Skills)[y];


			saved[phoneskill].forEach(item => MakeCard(item-1,phoneskill));

		});



	});



	$("body").on("click", ".back", function(){

		$("#tableView").fadeIn();
		$("#main").fadeOut();
	})


	function tableFadeIn(){
		$("#tableView").fadeIn();
	}

	GetAllData();


	check_session = setInterval(GetAllData, 10000);



</script>



